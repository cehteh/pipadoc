<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>pipadoc - Documentation extractor</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>pipadoc - Documentation extractor</h1>
<span id="author">Christian Thaeter</span><br />
<span id="email"><code>&lt;<a href="mailto:ct@pipapo.org">ct@pipapo.org</a>&gt;</code></span><br />
<span id="revdate">Wed Jan 25 18:56:23 2017</span>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>Embedding documentation in program source files often yields the problem that the
structure of a program is not the optimal structure for the associated documentation.
Still there are many good reasons to maintain documentation together with the source right within
the code which defines the documented functionality. Pipadoc addresses this problem by extracting
special comments out of a source file and let one define rules how to compile the
documentation into proper order.  This is somewhat similar to &#8220;literate Programming&#8221; but
it puts the emphasis back to the code.</p></div>
<div class="paragraph"><p>Pipadoc is programming language and documentation system agnostic, all it requires is that
the programming language has some form of comments starting with a defined character sequence
and spaning to the end of the source line. Moreover documentation parts can be written in plain text
files aside from the sources.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_history">History</h2>
<div class="sectionbody">
<div class="paragraph"><p>This <em>pipadoc</em> follows an earlier implementation with a slightly different (incompatible) syntax
and less features which was implemented in AWK. Updating to the new syntax should be straightforward
and is suggested for any projects using pipadoc.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_the_source">Getting the Source</h2>
<div class="sectionbody">
<div class="paragraph"><p>Pipadoc is managed the git revision contol system. You can clone the repository with</p></div>
<div class="literalblock">
<div class="content">
<pre><code>git clone --depth 1 git://git.pipapo.org/pipadoc</code></pre>
</div></div>
<div class="paragraph"><p>The <em>master</em> branch will stay stable and developement will be done on the <em>devel</em> branch.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="paragraph"><p>Pipadoc is single lua source file <code>pipadoc.lua</code> which is portable among most Lua versions
(PUC Lua 5.1, 5.2, 5.3 and Luajit). It ships with a <code>pipadoc.install</code> shell script which figures a
suitable Lua version out and installs <code>pipadoc.lua</code> as <code>pipadoc</code> in a given directory or the current
directory by default.</p></div>
<div class="paragraph"><p>There are different ways how this can be used in a project:</p></div>
<div class="ulist"><ul>
<li>
<p>
One can rely on a pipadoc installed in $PATH and just call that from the build toolchain
</p>
</li>
<li>
<p>
When a installed Lua version is known from the build toolchain one can include the <code>pipadoc.lua</code>
  into the project and call it with the known Lua interpreter.
</p>
</li>
<li>
<p>
One can ship the <code>pipadoc.lua</code> and <code>pipadoc.install</code> and do a local install in the build
  directory and use this pipadoc thereafter
</p>
</li>
</ul></div>
<div class="paragraph"><p>Pipadoc tries to load</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_usage">Usage</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre><code>pipadoc [options...] [inputs..]
  options are:
    -v, --verbose                           increment verbosity level
    -q, --quiet                             supresses any messages
    -d, --debug                             set verbosity to maximum
    -h, --help                              show this help
    -r, --register &lt;name&gt; &lt;file&gt; &lt;comment&gt;  register a filetype pattern
                                            for files matching a file pattern
    -t, --toplevel &lt;name&gt;                   sets 'name' as toplevel node [MAIN]
    -c, --config &lt;name&gt;                     selects a configfile [pipadoc.conf]
    --no-defaults                           disables default filetypes and processors
    -m, --markup &lt;name&gt;                     selects the markup engine for the output [text]
    --                                      stops parsing the options and treats each
                                            following argument as input file</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>inputs are filenames or a '-' which indicates standard input</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_concepts">Basic concepts</h2>
<div class="sectionbody">
<div class="paragraph"><p>Pipadoc is controlled by special line comments. This is choosen because the most common denominator
between almost all programming languages is that they have some form of <em>line comment</em>, that is some
character sequence which defines the rest of the line as comment.</p></div>
<div class="paragraph"><p>This line comments are enhanced by a simple syntax to make them pipadoc comments. The comment
character sequence followed directly (without any extra space character) by some definition (see below)
becomes a pipadoc comment.</p></div>
<div class="paragraph"><p>Pipadoc operates in some phases. First all given files are read and parsed and finally the output is
generated by bringing all accumulated documentation parts together into proper order.</p></div>
<div class="sect2">
<h3 id="syntax">Pipadoc Syntax</h3>
<div class="paragraph"><p>Any <em>linecomment</em> of the programming language directly (without spaces) followed by a optional
alphanumeric section name, followed by an operator, followed by an optional argument and then the
documentaton text. Only lines qualitfy this syntax are processed as pipapdoc documentation.</p></div>
<div class="paragraph"><p>The formal syntax looks like:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>pipadoc = [source] &lt;linecomment&gt; [section] &lt;operator&gt; [arg] [..space.. [documentation_text]]</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>source = ..any sourcecode text..</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>linecomment = ..the linecomment sequence choosen by the filetype..</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>section = ..alphanumeric text including underscore and dots, but without spaces..</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>operator = [:=@#] by default, one of the defined operators</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>arg = ..alphanumeric text including underscore and dots, but without spaces..</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>documentation_text = ..rest of the line, freeform text..</code></pre>
</div></div>
<div class="paragraph"><p>Documentation lines are proccessed according to their operator.</p></div>
</div>
<div class="sect2">
<h3 id="_order_of_operations">Order of operations</h3>
<div class="paragraph"><p>Pipadoc parse each file given on the commandline in order. Only lines which contain
pipadoc comments (see <a href="#syntax">[syntax]</a> above) are used in any further steps.
Reading files is done on a line by line base.</p></div>
<div class="paragraph"><p>After all files are read the output is generated by starting assembling the toplevel section
(<em>MAIN</em> if not otherwise defined).</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sections_and_keys">Sections and Keys</h2>
<div class="sectionbody">
<div class="paragraph"><p>Text in pipadoc is appended to named <em>sections</em>. Sections are later brought into the desired order in a <em>toplevel</em>
section. Additionally instead just appending text to a named section, text can be appended under some
alphanumeric key under that section. This enables later sorting for indexes and glossaries.</p></div>
<div class="paragraph"><p>Sections can span a block of lines (until another section is set) or one-line setting a section only for the current
comment line. Blocks are selected when the pipadoc comment defines a section and maybe a key but the rest of the
is empty, every subsequent line which does not define a new section block is then appended to the current block.</p></div>
<div class="paragraph"><p>One-Line sections are selected when a section and maybe a key are followed by some documentation text.</p></div>
<div class="paragraph"><p>When no section is set in a file, then the block section name defaults to the files name up, but excluding to the first dot.</p></div>
<div class="paragraph"><p>Pipadoc needs a receipe how to assemble all sections togehter. This is done in a <em>toplevel</em> section which defaults to the
name <em>MAIN</em>.</p></div>
<div class="listingblock">
<div class="title">An example document (assume the name example.sh)</div>
<div class="content">
<pre><code>#!/bin/sh
#: here the default section is 'example', derrived from 'example.sh'
#oneline:o this is appended to the section 'oneline' under key 'o'
#: back to the 'example' section
#newname:
#: this starts a new section block named 'newname'
#oneline:a this is appended to the section 'oneline' under key 'a'
#MAIN:
#: Assemble the document
#: first the 'newname'
#=newname
#: then 'example'
#=example
#: and finally 'oneline' alphabetically sorted by keys
#@oneline</code></pre>
</div></div>
<div class="paragraph"><p>Will result in</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Assemble the document
first the 'newname'
this starts a new section block named 'newname'
then 'example'
here the default section is 'example', derrived from 'example.sh'
back to the 'example' section
and finally 'oneline' alphabetically sorted by keys
this is appended to the section 'oneline' under key 'a'
this is appended to the section 'oneline' under key 'o'</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_filetypes">Filetypes</h2>
<div class="sectionbody">
<div class="paragraph"><p>Pipadoc needs to know about the syntax of line comments of the files it is reading. For this one can
register patterns to be matched against the filename together with a list of line comment characters.</p></div>
<div class="paragraph"><p>Pipadoc includes definitions for some common filetypes already. For languages which support block comments
the opening (but not the closing) commenting characters are registered as well. This allows for example to
define section blocks right away. But using the comment closing sequence right on the line will clobber the
output, just don&#8217;t do that!</p></div>
<div class="listingblock">
<div class="title">Example in C</div>
<div class="content">
<pre><code>/*blocksection:
//: this is a block-section
//: line comment sequences inside the block comment are still required
*/

/*works_too: but looks ugly
*/

/*fail: don't do this, pipadoc comments span to the end of the line */ void* text;</code></pre>
</div></div>
<div class="paragraph"><p>A special case is that when a line comment is defined as an empty string ("") then every line of a file is
considered as documentation but no special operations apply. This is used for parsing plaintext documentation
files. Which also uses the "PIPADOC:" keyword to enable special operations within text files.</p></div>
<div class="sect2">
<h3 id="_pipadoc_has_builtin_support_for_following_languages">pipadoc has builtin support for following languages</h3>
<div class="ulist"><ul>
<li>
<p>
Autoconf, Automake
</p>
</li>
<li>
<p>
C, C++, Headerfiles
</p>
</li>
<li>
<p>
CMake
</p>
</li>
<li>
<p>
Delphi, Pascal
</p>
</li>
<li>
<p>
Java, C#
</p>
</li>
<li>
<p>
Javascript
</p>
</li>
<li>
<p>
Lua
</p>
</li>
<li>
<p>
Makefiles
</p>
</li>
<li>
<p>
Objective-C
</p>
</li>
<li>
<p>
PHP
</p>
</li>
<li>
<p>
Prolog
</p>
</li>
<li>
<p>
Python
</p>
</li>
<li>
<p>
Ruby
</p>
</li>
<li>
<p>
SCons
</p>
</li>
<li>
<p>
Shell, Perl, AWK
</p>
</li>
<li>
<p>
SQL
</p>
</li>
<li>
<p>
Textfiles, Pipadoc (<code>.pdoc</code>)
</p>
</li>
<li>
<p>
Visual Basic
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operators">Operators</h2>
<div class="sectionbody">
<div class="paragraph"><p>Operators define the core functionality of pipadoc. They are mandatory in the pipadoc syntax
to define a pipadoc comment line. It is possible (but rarely needed) to define additional
operators. Operators must be a single punctuation character</p></div>
<div class="sect2">
<h3 id="_built_in_operators">Built in operators</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>:</code> 
</dt>
<dd>
<p>
  The documentation operator. Defines normal documentation text. Each pipadoc comment using the <code>:</code>
  operator is processed as potential documentation. First all enabled <em>processors</em> are run over it and
  finally the text is appended to the current section(/key)
</p>
</dd>
<dt class="hdlist1">
<code>=</code> 
</dt>
<dd>
<p>
  Section paste operator. Takes a section name as argument and will paste that section in place.
</p>
</dd>
<dt class="hdlist1">
<code>@</code> 
</dt>
<dd>
<p>
  Takes a section name as argument and will paste section text alphabetically sorted by their keys.
</p>
</dd>
<dt class="hdlist1">
<code>#</code> 
</dt>
<dd>
<p>
  Takes a section name as argument and will paste section text numerically sorted by their keys.
</p>
</dd>
</dl></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="DOCVARS">Documentation Variables</h2>
<div class="sectionbody">
<div class="paragraph"><p>The <em>DOCVARS</em> Lua table holds key/value pairs of variables with the global state
of pipadoc. These can be used by the core and plugins in various ways. Debugging
for example prints the FILE:LINE processed and there is the <em>varsubst</em> processor
to substitute them in the documentation text. The user can set arbitary DOCVARS
from commandline.</p></div>
<div class="sect2">
<h3 id="_predefined_docvars">Predefined DOCVARS</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>YEAR, MONTH, DAY, HOUR, MINUTE</code>
</dt>
<dd>
<p>
  Current date information
</p>
</dd>
<dt class="hdlist1">
<code>DATE</code>
</dt>
<dd>
<p>
  Current date in YEAR/MONTH/DAY format
</p>
</dd>
<dt class="hdlist1">
<code>FILE</code>
</dt>
<dd>
<p>
  The file or section name currently processed or some special annotation
  in angle brakets (eg <em>&lt;startup&gt;</em>) on other processing phases
</p>
</dd>
<dt class="hdlist1">
<code>LINE</code>
</dt>
<dd>
<p>
  Current line number of input or section, or indexing key
  Lines start at 1
</p>
</dd>
<dt class="hdlist1">
<code>NL</code>
</dt>
<dd>
<p>
  The linebreak character sequence, usually <em>\n</em> on unix systems but
  can be changed with a commandline option
</p>
</dd>
<dt class="hdlist1">
<code>SECTION</code>
</dt>
<dd>
<p>
  stores the current section name
</p>
</dd>
</dl></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_programming_api_for_extensions">Programming API for extensions</h2>
<div class="sectionbody">
<div class="paragraph"><p>Some pipadoc lua functions are documented here to be used from plugins.</p></div>
<div class="sect2">
<h3 id="_logging_progress_and_errors">Logging Progress and Errors</h3>
<div class="paragraph"><p>There are few function to log progress and report errors. All this functions take a
variable argument list. Any Argument passed to them will be converted to a string and printed
to stderr when the verbosity level is high enough.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>warn(&#8230;)</code>
</dt>
<dd>
<p>
  report a important but non fatal failure
</p>
</dd>
<dt class="hdlist1">
<code>echo(&#8230;)</code>
</dt>
<dd>
<p>
  report normal progress
</p>
</dd>
<dt class="hdlist1">
<code>dbg(&#8230;)</code>
</dt>
<dd>
<p>
  show debugging information
</p>
</dd>
<dt class="hdlist1">
<code>trace(&#8230;)</code>
</dt>
<dd>
<p>
  show more detailed progress information
</p>
</dd>
<dt class="hdlist1">
<code>die(&#8230;)</code>
</dt>
<dd>
<p>
  report a fatal error and exit the programm
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_optional_lua_modules">Optional Lua Modules</h3>
<div class="paragraph"><p><em>pipadoc</em> does not depend on any nonstandard Lua libraries, because they may not be installed on the target
system. But some modules can be loaded optionally to augment its behavior and provide extra features.
Plugin-writers should try to adhere to this practice if possible and use the <em>request</em> function instead the
Lua <em>require</em>.</p></div>
<div class="paragraph"><p>When luarocks is installed, then the <em>luarocks.loader</em> is loaded by default to make any module installed by
luarocks available.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>request(name)</code>
</dt>
<dd>
<p>
  try to load optional modules
   wraps lua <em>require</em> in a pcall so that failure to load a module results in <em>nil</em> rather than a error
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_typechecks">Typechecks</h3>
<div class="paragraph"><p>Some wrapers around <em>assert</em> to check externally supplied data. On success <em>var</em> will be returned
otherwise an assertion error is raised.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>assert_type(var, expected)</code>
</dt>
<dd>
<p>
  checks that the <em>var</em> is of <em>type</em>
</p>
</dd>
<dt class="hdlist1">
<code>maybe_type(var, expected)</code>
</dt>
<dd>
<p>
  checks that the <em>var</em> is of <em>type</em> or nil
</p>
</dd>
<dt class="hdlist1">
<code>assert_char(var)</code>
</dt>
<dd>
<p>
  checks that <em>var</em> is a single character
</p>
</dd>
<dt class="hdlist1">
<code>assert_notnil(var)</code>
</dt>
<dd>
<p>
  checks that <em>var</em> is not <em>nil</em>
</p>
</dd>
<dt class="hdlist1">
<code>to_table(v)</code>
</dt>
<dd>
<p>
  if <em>v</em> is not a table then return v
</p>
</dd>
<dt class="hdlist1">
<code>to_text (v)</code>
</dt>
<dd>
<p>
  convert <em>v</em> to a string, returns <em>nil</em> when that string would be empty
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_string_evaluation">String evaluation</h3>
<div class="paragraph"><p>Documentation text is passed to the streval() function which recursively evaluates lua expression inside
curly braces. This can be used to retrieve the value of variables, call or define functions. when the
text inside curly braces can not be evaluated it is retained verbatim. One can escape curly braces
the backslash and the backtick itself by prepending them with a backslash or backtick.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>streval (str)</code>
</dt>
<dd>
<p>
  evaluate lua code inside curly braces in str
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_sections">Sections</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>section_append(section, key, context)</code>
</dt>
<dd>
<p>
  Append data to the given section/key
</p>
<div class="dlist"><dl>
<dt class="hdlist1">
section
</dt>
<dd>
<p>
    name of the section to append to, must be a string
</p>
</dd>
<dt class="hdlist1">
key
</dt>
<dd>
<p>
    the subkey for sorting within that section. <em>nil</em> for appending text to normal sections
</p>
</dd>
<dt class="hdlist1">
context
</dt>
<dd>
</dd>
</dl></div>
</dd>
<dt class="hdlist1">
<code>section_get(section, key, index)</code>
</dt>
<dd>
<p>
  query the value of the given section/key at index (or at end)
</p>
<div class="dlist"><dl>
<dt class="hdlist1">
section
</dt>
<dd>
<p>
    name of the section to append to, must be a string
</p>
</dd>
<dt class="hdlist1">
key
</dt>
<dd>
<p>
    the subkey for sorting within that section. maybe <em>nil</em>
</p>
</dd>
<dt class="hdlist1">
index
</dt>
<dd>
<p>
    line number to query, when <em>nil</em> defaults to the last line
</p>
</dd>
<dt class="hdlist1">
returns
</dt>
<dd>
<p>
    value or nil
</p>
</dd>
</dl></div>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_filetypes_2">Filetypes</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>filetype_register(name, filep, linecommentseqs)</code>
</dt>
<dd>
<p>
  Register a new filetype
</p>
<div class="dlist"><dl>
<dt class="hdlist1">
name
</dt>
<dd>
<p>
      name of the language
</p>
</dd>
<dt class="hdlist1">
filep
</dt>
<dd>
<p>
      a Lua pattern or list of patterns matching filename
</p>
</dd>
<dt class="hdlist1">
linecommentseqs
</dt>
<dd>
<p>
      a string or list of strings matching comments of the registered filetype
</p>
</dd>
</dl></div>
</dd>
</dl></div>
<div class="paragraph"><p>For example, C and C++ Filetypes are registered like:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>filetype_register("C", "%.c$","%.cpp$","%.C$", "%.cxx$", "%.h$", "//", "/*")</code></pre>
</div></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<code>operator_register(char, func)</code>
</dt>
<dd>
<p>
  Register a new operator
</p>
<div class="dlist"><dl>
<dt class="hdlist1">
char
</dt>
<dd>
<p>
    single punctuation character defining this operator
</p>
</dd>
<dt class="hdlist1">
func
</dt>
<dd>
<p>
    a function which receives a table of the <em>context</em> parsed from the pipadoc commentline
</p>
</dd>
</dl></div>
</dd>
</dl></div>
<div class="paragraph"><p>Operators drive the main functionality, like invoking the processors and generating the output.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_generate_the_pipadoc_documentation_itself">How to generate the pipadoc documentation itself</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>pipadoc</em> documents itself with embedded asciidoc text. This can be extracted with</p></div>
<div class="listingblock">
<div class="content">
<pre><code>lua pipadoc.lua -m asciidoc -d pipadoc.lua &gt;pipadoc.txt</code></pre>
</div></div>
<div class="paragraph"><p>The resulting <code>pipadoc.txt</code> can then be processed with the asciidoc toolchain to produce
distribution formats:</p></div>
<div class="listingblock">
<div class="content">
<pre><code># generate HTML
asciidoc -a toc pipadoc.txt

# generate PDF
a2x -L -k -v --dblatex-opts "-P latex.output.revhistory=0" pipadoc.txt</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_development">Development</h2>
<div class="sectionbody">
</div>
</div>
<div class="sect1">
<h2 id="_gnu_general_public_license">GNU General Public License</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><code>pipadoc - Documentation extractor
Copyright (C)                        Pipapo Project
 2015, 2016, 2017                    Christian Thaeter &lt;ct@pipapo.org&gt;

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code></pre>
</div></div>
<div class="sect2">
<h3 id="_license_explanation">License Explanation</h3>
<div class="paragraph"><p>The License (GPL) only applies to pipadoc and any derivative work. The purpose of pipadoc
is to extract documentation from other files, this does not imply that these source files
from which the documentation is extracted need to be licensed under the GPL, neither does
this imply that the extracted documentaton need to be licensed under the GPL.
Using pipadoc for propietary software poses no problems about the Licenensing terms of
this software.</p></div>
<div class="paragraph"><p>The GPL applies when you distribute pipadoc itself, in original or modified form. Since
pipadoc is written in Lua you already distribute its source as well, which makes this
distribution naturally with the GPL.</p></div>
<div class="paragraph"><p>Nevertheless, when you make any improvements to pipadoc please consider to contact
Christian Thäter &lt;<a href="mailto:ct@pipapo.org">ct@pipapo.org</a>&gt; for including them into the mainline.</p></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2017-01-25 18:56:23 CET
</div>
</div>
</body>
</html>
